var g=function(){X.id="",X.target=null,X.type="",X.depth=0,X.parentId="",X.formType=""},p=function(){Z.index=void 0,Z.parentId=void 0,Z.title="",Z.url=void 0},w=function(){$.BTNode=null,$.target=null,$.timeout=void 0},d=function(_){var{open:L,focusTabs:x,foldersBefore:z}=_,j=!1;if(L===void 0)j=!0;else K.open=L,A.modalConfigOpen.value=L;if(x===void 0||typeof x!=="boolean")j=!0;else K.focusTabs=x,A.modalConfigFocus.checked=x;if(z===void 0)j=!0;else K.folderBefore=z,A.modalConfigFolders.checked=z;if(j)chrome.storage.local.set(K,void 0)},o=function(_,L,x,z){var j=_[z];_[z]=_[x],_[x]=j;let G=0;for(let J=L;J<x;J+=1)if(_[J].title.localeCompare(_[x].title)<0)j=_[G+L],_[G+L]=_[J],_[J]=j,G+=1;return j=_[G+L],_[G+L]=_[x],_[x]=j,G+L},N=function(_,L,x){if(x-L<1)return _;let z=[L,x],j=0,G=0;while(z.length>0){if(L=z.shift(),x=z.shift(),j=Math.floor(Math.random()*(x-L)+L),G=o(_,L,x,j),G-1-L>0)z.push(L,G-1);if(x-(G+1)>0)z.push(G+1,x)}return _},a=function(_){let L=0;if(K.foldersBefore){for(let x=0;x<_.length;x+=1){let z=_[x];if(z.url===void 0){if(x!==L){let j=_[L];_[L]=z,_[x]=j}L+=1}}N(_,0,L-1),N(_,L,_.length-1)}else N(_,0,_.length-1);return _},D=function(_,L){_.firstElementChild.firstElementChild.lastElementChild.textContent=L},T=function(_,L,x,z){if(_.url===void 0)Y("BookmarkTreeNode.url is undefined");var j=x.content.cloneNode(!0),G=j.firstElementChild;G.setAttribute("data-id",_.id),G.setAttribute("data-depth",String(L)),G.setAttribute("title",`${_.title}\n${_.url}`);var J=G.firstElementChild;J.setAttribute("href",_.url),J.style.setProperty("padding-left",`${L*10}px`);var Q=J.children[0];Q.setAttribute("src",r(_.url));var U=J.children[1];if(U.textContent=_.title,z!==void 0){var V=G.lastElementChild,H=z.content.children,k=H[2].cloneNode(!0),b=H[5].cloneNode(!0);b.classList.add("c_center-children"),V.appendChild(k),V.appendChild(b)}return G},O=function(_,L,x){const z=_.firstElementChild;z.setAttribute("href",x),z.lastElementChild.textContent=L},M=function(_,L,x,z,j,G){var J=[x],Q=[_],U=-1,V,H;while(Q.length>0)if(V=Q[Q.length-1],V.children===void 0||U+1===V.children.length){if(Q.pop(),V.index===void 0)Y("BookmarkTreeNode.index is undefined");if(U=V.index,H=J.pop(),J.length>0)J[J.length-1].appendChild(H);L-=1}else{if(V=V.children[U+1],L+=1,V.children!==void 0)J.push(C(V,L,z,G));else J.push(T(V,L,j,G));Q.push(V),U=-1}return x},e=function(_){if(_.length===0||_[0].children===void 0||_[0].children.length===0)Y("The bookmark roots does not exist");var L=_[0].children,x=A.templateButtons.content.children,z=x[0],j=x[1],G=x[4];for(var J=0;J<L.length;J+=1){var Q=L[J],U=C(Q,1,A.templateDir,void 0);if(J==0)U.setAttribute("data-open","1");var V=U.firstElementChild.children[1],H=G.cloneNode(!0);if(H.classList.add("c_center-children"),V.appendChild(z.cloneNode(!0)),V.appendChild(j.cloneNode(!0)),V.appendChild(H),Q.children!==void 0&&Q.children.length>0)M(Q,1,U,A.templateDir,A.templateItem,A.templateButtons);A.fragment.appendChild(U)}A.main.appendChild(A.fragment)},t=function(_){var L=_.target,x=L.getAttribute("data-button");if(x===null)Y("ButtonType is null");if(x==="0")P.url="chrome://bookmarks/",P.active=!0,chrome.tabs.create(P,void 0);else if(x==="1")A.modal.setAttribute("data-display","1"),A.modal.setAttribute("data-show","0");else if(x==="2")window.close()};async function __(_,L){var x=L,z=[L],j=[],G=[],J=[],Q=_;Z.url=Q.url,Z.index=Q.index,Z.title=Q.title,Z.parentId=Q.parentId;var U=await chrome.bookmarks.create(Z,void 0);if(L.setAttribute("data-id",U.id),Q.children.length>0)j.push(U.id),Array.prototype.push.apply(J,Q.children);while(J.length>0){if(Q=J.shift(),Q.index===void 0)Y("BookmarkTreeNode.index is undefined");var V=Q.children!==void 0;if(!V&&G.length>0&&G[0]===Q.id)z.shift(),G.shift(),j.shift();Z.url=Q.url,Z.index=Q.index,Z.title=Q.title,Z.parentId=j[0];var U=await chrome.bookmarks.create(Z,void 0);if(L=z[0].children[Q.index+1],L.setAttribute("data-id",U.id),V&&Q.children.length>0)z.push(L),j.push(U.id),G.push(Q.children[0].id),Array.prototype.push.apply(J,Q.children)}A.messageUndo.setAttribute("data-display","0"),x.setAttribute("data-display","1"),w()}var L_=function(_){if(_===void 0)return;$.target.setAttribute("data-id",_.id),$.target.setAttribute("data-display","1"),A.messageUndo.setAttribute("data-display","0"),w()},x_=function(_){var L=_.target,x=L.getAttribute("data-button");if(x==="1")clearTimeout($.timeout),$.target.remove(),A.messageUndo.setAttribute("data-display","0"),w();else if(x==="0"){if($.timeout===void 0){console.warn("The undo action cannot be completed. The element was deleted"),w();return}if(clearTimeout($.timeout),$.target===null)Y("DeleteState.target is null");var z=$.BTNode;if(z===null)Y("DelteState.BTNode is null");if(z.children===void 0)Z.parentId=z.parentId,Z.url=z.url,Z.index=z.index,Z.title=z.title,chrome.bookmarks.create(Z,L_);else __(z,$.target)}},A_=function(_){_.remove(),A.messageUndo.setAttribute("data-display","0"),w()},m=function(_){if(_.length===0){if($.target!==null)$.target.remove();w();return}var L=_[0];$.BTNode=L,A.messageUndo.setAttribute("data-display","1");var x=A.messageUndo.children;if(x[0].textContent=L.title,x[1].textContent="removed",L.url===void 0)chrome.bookmarks.removeTree(L.id,void 0);else chrome.bookmarks.remove(L.id,void 0);$.timeout=setTimeout(A_,2000,$.target)},j_=function(_){if($.timeout!==void 0)clearTimeout($.timeout),$.target.remove();var L=_.parentElement,x=L.getAttribute("data-parent"),z="";if(x==="0"){var j=L.parentElement.parentElement;j.setAttribute("data-display","0"),z=j.getAttribute("data-id"),$.target=j,chrome.bookmarks.getSubTree(z,m)}else{var G=L.parentElement;G.setAttribute("data-display","0"),z=G.getAttribute("data-id"),$.target=G,chrome.bookmarks.get(z,m)}},z_=function(_){var L=A.modalForm;if(_.length===0)Y("What the fuck, data is empty");var x=_[0];if(x.title!==void 0)L[0].value=x.title;if(x.url!==void 0)L[1].value=x.url;A.modal.setAttribute("data-display","1"),A.modal.setAttribute("data-show","1"),L[0].focus()},G_=function(_){var L=A.modal.children[1],x=_.parentElement,z=x.getAttribute("data-parent"),j="";if(X.formType="0",z==="0"){L.firstElementChild.firstElementChild.textContent="Edit folder";let G=x.parentElement.parentElement;X.target=G;let J=G.getAttribute("data-id");if(J!==null)j=J}else{L.firstElementChild.firstElementChild.textContent="Edit bookmark";let G=x.parentElement;X.target=G;let J=G.getAttribute("data-id");if(J!==null)j=J}if(j.length===0)Y("id is empty");X.id=j,X.type=z,L.setAttribute("data-edit",z),chrome.bookmarks.get(j,z_)},S=function(_,L,x){var z=_.parentElement.parentElement.parentElement,j=A.modalForm,G=z.getAttribute("data-id");if(G===null)Y("id is null");X.parentId=G,X.formType="1",X.target=z,X.depth=Number(z.getAttribute("data-depth"));var J=A.modal.children[1];if(J.setAttribute("data-edit",L),L==="0")J.firstElementChild.firstElementChild.textContent="CreateOptions folder";else{if(!x)j[0].value=I.title,j[1].value=I.url;J.firstElementChild.firstElementChild.textContent="CreateOptions bookmark"}A.modal.setAttribute("data-display","1"),A.modal.setAttribute("data-show","1"),j[0].focus()};async function J_(_){if(a(_),W.target===null)Y("SortState.target is null");const L=W.target.children,x=[L[0]];for(let j=0;j<_.length;j+=1){var z=_[j];R.index=j,R.parentId=W.parentId,await chrome.bookmarks.move(z.id,R),x.push(L[z.index+1])}Element.prototype.replaceChildren.apply(W.target,x),W.target=null,W.parentId=""}var Q_=function(_){let L=_.getAttribute("data-id");if(L===null)Y("data-id is null");W.target=_,W.parentId=L,chrome.bookmarks.getChildren(L,J_)},V_=function(_){if(_===void 0||_.length===0)return;P.active=!1;for(let x=0;x<_.length;x+=1){var L=_[x];if(L.url!==void 0)P.url=L.url,chrome.tabs.create(P)}},u=function(_){if(_===void 0||_.length===0)return;F.url.length=0;for(let x=0;x<_.length;x+=1){var L=_[x];if(L.url!==void 0)F.url.push(L.url)}chrome.windows.create(F)},X_=function(_){var L=_.target;const x=L.getAttribute("data-type");if(x==="10")_.preventDefault(),j_(L);else if(x==="9"){_.preventDefault();let j=L.parentElement.parentElement.parentElement;Q_(j)}else if(x==="11"){_.preventDefault();let G=L.parentElement.parentElement.parentElement.getAttribute("data-id");chrome.bookmarks.getChildren(G,V_)}else if(x==="12"){_.preventDefault();let G=L.parentElement.parentElement.parentElement.getAttribute("data-id");F.incognito=!1,chrome.bookmarks.getChildren(G,u)}else if(x==="13"){_.preventDefault();let G=L.parentElement.parentElement.parentElement.getAttribute("data-id");F.incognito=!0,chrome.bookmarks.getChildren(G,u)}else if(x==="7")_.preventDefault(),G_(L);else if(x==="6")_.preventDefault(),S(L,"0",!1);else if(x==="5")_.preventDefault(),S(L,"2",_.ctrlKey);else if(x==="3"){if(!_.shiftKey){_.preventDefault();var z=L.getAttribute("href");i(z,_.ctrlKey)}}else if(x==="1"){_.preventDefault();let j=L.parentElement.parentElement;if(j.getAttribute("data-open")==="0")j.setAttribute("data-open","1");else j.setAttribute("data-open","0")}},Y_=function(_){var L=_.target,x=L.getAttribute("data-type");if(x==="8"){var z=L.parentElement.parentElement.parentElement,j=L.parentElement.nextElementSibling,G=A.main.offsetHeight+A.main.scrollTop-(j.offsetHeight+L.parentElement.parentElement.offsetHeight);if(G<z.offsetTop)j.style.setProperty("top","unset"),j.style.setProperty("bottom","30px");else j.style.setProperty("top","30px"),j.style.setProperty("bottom","unset")}},Z_=function(_){var L=_.target,x=L.getAttribute("data-type");if(x=="4"||x==="10"){var z=A.modal.getAttribute("data-show");if(z==="1"){if(X.formType==="1")p();g();var j=A.modal.children[1];j.setAttribute("data-edit","");var G=A.modalForm;G[0].value="",G[1].value="",A.modal.setAttribute("data-display","0"),A.modal.setAttribute("data-show","")}A.modal.setAttribute("data-display","0"),A.modal.setAttribute("data-show","")}},$_=function(_){if(_===void 0)return;if(X.target===null)Y("ModalState.target is null");if(_.url===void 0)D(X.target,_.title);else O(X.target,_.title,_.url);g()};var U_=function(_){if(_===void 0)return;if(X.target===null)Y("ModalState.target is null");var L;if(v.id=_.id,v.title=_.title,_.url===void 0)L=C(v,X.depth+1,A.templateDir,A.templateButtons);else v.url=_.url,L=T(v,X.depth+1,A.templateItem,A.templateButtons);X.target.appendChild(L),p(),g()},K_=function(_){_.preventDefault();var L=A.modalForm,x=A.modal?.children[1],z=L[0].value;if(X.formType==="0"){if(E.title=z,X.type==="0")E.url="";else{var j=L[1].value;E.url=j}chrome.bookmarks.update(X.id,E,$_)}else{if(Z.parentId=X.parentId,Z.title=z,X.type==="0")Z.url=void 0;else{var j=L[1].value;Z.url=j}chrome.bookmarks.create(Z,U_)}x.setAttribute("data-edit",""),L[0].value="",L[1].value="",A.modal.setAttribute("data-display","0"),A.modal.setAttribute("data-show","")},H_=function(_){var L=_.currentTarget;K.open=L.value,chrome.storage.local.set(K,void 0)},P_=function(_){var L=_.currentTarget;K.focusTabs=L.checked,chrome.storage.local.set(K,void 0)},W_=function(_){var L=_.currentTarget;K.foldersBefore=L.checked,chrome.storage.local.set(K,void 0)},w_=function(_){I=_[0],A.headerButtons.onclick=t,A.messageUndo.lastElementChild.onclick=x_,A.main.onclick=X_,A.main.onpointerover=Y_,A.modalConfigOpen.onchange=H_,A.modalConfigFocus.onchange=P_,A.modalConfigFolders.onchange=W_,A.modal.onclick=Z_,A.modalForm.onsubmit=K_,chrome.bookmarks.getTree(e)},q_=function(){if(A.templateDir=document.getElementById("template_dir"),A.templateDir===null)Y("DOM.templateDir is null");if(A.templateItem=document.getElementById("template_item"),A.templateItem===null)Y("DOM.templateItem is null");if(A.templateButtons=document.getElementById("template_buttons"),A.templateButtons===null)Y("DOM.templateButtons is null");if(A.headerButtons=document.getElementById("header_buttons"),A.headerButtons===null)Y("DOM.headerButtons is null");if(A.messageUndo=document.getElementById("message_undo"),A.messageUndo===null)Y("DOM.messageUndo is null");if(A.main=document.getElementById("main"),A.main===null)Y("DOM.main is null");if(A.modal=document.getElementById("modal"),A.modal===null)Y("DOM.modal is null");if(A.modalForm=document.getElementById("modal_form"),A.modalForm===null)Y("DOM.modalForm is null");if(A.modalConfigOpen=document.getElementById("modal_config-open"),A.modalConfigOpen===null)Y("DOM.modalConfigOpen is null");if(A.modalConfigFocus=document.getElementById("modal_config-focus"),A.modalConfigFocus===null)Y("DOM.modalConfigFocus is null");if(A.modalConfigFolders=document.getElementById("modal_config-folders"),A.modalConfigFolders===null)Y("DOM.modalConfigFolders is null");chrome.storage.local.get(void 0,d),chrome.tabs.query({active:!0,currentWindow:!0},w_)};var A={templateDir:null,templateItem:null,templateButtons:null,headerButtons:null,messageUndo:null,main:null,modal:null,modalConfigOpen:null,modalConfigFocus:null,modalConfigFolders:null,modalForm:null,fragment:document.createDocumentFragment()},K={focusTabs:!1,foldersBefore:!0,open:"0"},X={id:"",target:null,type:"",depth:0,parentId:"",formType:""},E={title:"",url:""},Z={index:void 0,parentId:void 0,title:"",url:void 0},$={BTNode:null,target:null,timeout:void 0},W={target:null,parentId:""},R={index:0,parentId:""},I=void 0,Y=function(_){throw Error(_)},P={active:!1,url:""},i=function(_,L){if(P.url=_,P.active=K.focusTabs,K.open==="0"===!L)chrome.tabs.update(I.id,P,void 0);else chrome.tabs.create(P,void 0)},f=new URL("http://t.i"),r=function(_){return f.href=chrome.runtime.getURL("/_favicon/"),f.searchParams.set("pageUrl",_),f.searchParams.set("size","16"),f.toString()},C=function(_,L,x,z){var j=x.content.cloneNode(!0),G=j.firstElementChild;G.setAttribute("data-id",_.id),G.setAttribute("data-depth",String(L)),G.setAttribute("title",_.title);var J=G.firstElementChild,Q=J.firstElementChild;Q.style.setProperty("padding-left",`${L*10}px`);var U=Q.lastElementChild;if(U.textContent=_.title,z!==void 0){var V=z.content.cloneNode(!0).children,H=V[0],k=V[1],b=V[2],B=V[3],h=V[4],c=V[5],n=V[6],s=V[7],l=V[8],y=J.children[1],q=J.children[2];y.appendChild(H),y.appendChild(k),y.appendChild(b),y.appendChild(B),h.insertAdjacentText("beforeend","Sort A-Z"),c.insertAdjacentText("beforeend","Remove folder"),q.appendChild(n),q.appendChild(s),q.appendChild(l),q.appendChild(h),q.appendChild(c)}return G},F={incognito:!1,url:[],setSelfAsOpener:!1},v={id:"",title:"",url:""};window.addEventListener("DOMContentLoaded",q_);
